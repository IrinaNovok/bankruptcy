# bankruptcy
Analysis of transactions (анализ сделок)

Инструкция по работе с программой «Анализ сделок».
1.	Распаковать архив с программой и запустить файл Анализ сделок.bat. Откроется окно программы: 
 
2.	Выбрать файл с выпиской для анализа (кнопка "Выбрать файл"). Для анализа доступны файлы с расширением xls и xlsx. 
3.	В результате в программе создается столько вкладок с листами, сколько страниц содержится в выбранном файле.
4.	Становится доступной кнопка "Открыть файл". Она служит для открытия выбранного файла с выпиской. Эта функция никак не влияет на дальнейшую работу программы и служит скорее для удобства. Нажимать на данную кнопку не обязательно. Но для дальнейшей работы с программой пользователю необходим просмотр выбранного файла.
5.	Для каждой страницы файла с выпиской следует указать, содержит ли он сделки для анализа. Если страница содержит сделки, установить соответствующую галочку на вкладке с номером листа. Если на странице сделок нет, то она не должна участвовать в анализе и  галочку на вкладке с номером такого листа устанавливать не нужно.
6.	Если галочка на листе установлена, поля становятся доступными для заполнения.  
Эти данные необходимы для того, чтобы идентифицировать колонки файла с выпиской (для каждой страницы), в которых находится необходимая информация для дальнейшего анализа сделок.
7.	Для корректного заполнения полей необходимо выбрать способ представления реквизитов контрагента и суммы в выписке. 
8.	Для удобства пользователя в окне программы (в правой части) отображается пример файла с выбранным способ представления информации.  
9.	В зависимости от того, какие способы представления информации выбраны, необходимо заполнить поля, расположенные ниже. Возможны следующие варианты:
9.1.	В выписке содержится две колонки с суммой (Дт и Кт) и реквизиты счетов по Дт и по Кт представлены в разных колонках. В данном случае пользователь заполняет следующие поля из соответствующей страницы выбранной выписки:
•	Название колонки с порядковым номером операции – это не обязательное для заполнения поле. Служит для удобства дальнейшей работы с результатом анализа, чтобы упростить поиск найденных сделок.
•	Дата операции – обязательное поле. Именно по нему определяется количество сделок в файле. Если название колонки с датой указано некорректно, анализ будет неверен (или невозможен). 
•	Сумма расхода (Дт) – обязательное поле.
•	Сумма прихода (Кт) – обязательное поле.
•	Назначение платежа – обязательное поле.
•	Счет плательщика (Дт) – обязательное поле. 
•	Счет получателя (Кт) – обязательное поле. 
9.2.	В выписке содержится две колонки с суммой (Дт и Кт) и реквизиты контрагента представлены в разных колонках (нет разбиения реквизитов счетов на Дт и Кт). В данном случае вместо счетов плательщика и получателя пользователю необходимо указать следующие поля:
•	Наименование контрагента – обязательное поле. 
•	ИНН/счет контрагента – необязательное для заполнения поле. Не во всех выписках существует колонка с ИНН или номером счета контрагента. При желании пользователь может указать здесь колонку с той цифровой информацией, по которой в дальнейшем он хочет установить отбор.  
9.3.	В выписке содержится одна колонка с суммой и реквизиты счетов по Дт и по Кт представлены в разных колонках. В данном случае вместо суммы прихода (Кт) и суммы расхода (Дт) пользователю необходимо указать следующие поля:
•	Выписка по счету – обязательное поле. Это единственное поле, в котором указывается не название колонки, а реальный номер счета из выписки. Здесь возможно указать как номер счета цифрами, так и название счета. Главное правило – счет указать так, как он представлен в шапке файла с выпиской и в колонке с реквизитами счетов.  
•	Сумма операции – обязательное поле.  
Важно! Все названия колонок должны быть заполнены в четком соответствии с представлением их в файле Excel: латинскими заглавными буквами. 
Кнопка "?" напротив каждого поля служит для отображения примера заполнения соответствующего поля. 
10.	 По кнопке  "Получить данные из файла" загрузить в программу данные из выбранного файла с выпиской в соответствии с теми колонками, которые были указаны выше. Если в предыдущем пункте названия колонок были заполнены некорректно, программа сообщит об этом пользователю с выделением тех полей, которые нужно исправить. В результате заполнится табличная часть, расположенная под указанной кнопкой. Пользователю необходимо проанализировать, все ли колонки заполнены корректно. Если данные загрузились неправильно, необходимо еще раз внимательно выполнить пункт 9 данной инструкции. Основные моменты при загрузке:
•	Если в выписке реквизиты счетов по Дт и по Кт представлены в разных колонках, то при загрузке данных из файла программа пытается выделить среди реквизитов счетов ИНН и занести его в соответствующий столбец. Если ИНН в реквизитах не указан, то столбец с ИНН остается пустым, а в столбец с наименованием заносятся все данные, указанные в счете.
•	Если реквизиты контрагента представлены в разных колонках (нет разбиения реквизитов счетов на Дт и Кт), то при загрузке данных из колонки, заданной для ИНН/счета остаются только цифры (все нецифровые символы убираются). 
•	 Если в выписке колонка с суммой одна, то при загрузке данных анализируется по каждой сделке, совпадает ли счет, указанный пользователем со счетом Дт или Кт. В зависимости от этого, загружается корректное ИНН, наименование, сумма расхода (Дт) и сумма прихода (Кт).
11.	 Если все данные из файла загрузились корректно, то информация о количестве загруженных сделок, сумме по Дт и сумме по Кт должна совпасть с данными из соответствующей страницы файла. Эта информация отражается в нижней части окна программы.    
12.	 Пункты 5 – 11 данной инструкции должны быть проделаны для каждой вкладки с листами.
13.	 После того, как данные для анализа корректно загружены, перейти на вкладку Анализ данных. 
Для начала анализа сделок (кроме последней вкладки с универсальным анализом сделок) необходимо указать дату принятия заявления о банкротстве (месяц указывается числом, год – полностью). Если дата указана некорректно, программа сообщит об этом пользователю с указанием полей, которые необходимо исправить. 
14.	 Возможны следующие виды анализа:
1.	Поиск сделок с предпочтением (вкладка Сделки с предпочтением). Анализ таких сделок доступен отдельно за месяц и за полгода (соответствующие вкладки). В сделки с предпочтением попадают все сделки, по которым:
•	дата не раньше, чем за месяц (или за полгода, в зависимости от выбранной вкладки) до указанной даты подачи заявления о банкротстве;
•	заполнена сумма расхода;
•	дата в назначении платежа раньше даты подачи заявления о банкротстве, либо дата в назначении не указана.
2.	Поиск сделок с неравноценным встречным исполнением (вкладка Сделки с неравноценным встречным исполнением). Анализ таких сделок доступен отдельно за год и за 3 года (соответствующие вкладки). В данный анализ попадают все сделки, по которым дата не раньше, чем за год (или за 3 года, в зависимости от выбранной вкладки) до указанной даты подачи заявления о банкротстве.
3.	Поиск сделок со злоупотреблением правом (вкладка Сделки со злоупотреблением правом). Анализ таких сделок доступен отдельно за 10 лет. В данный анализ попадают все сделки, по которым дата не раньше, чем за 10 лет до указанной даты подачи заявления о банкротстве.
4.	Универсальный анализ сделок (вкладка Универсальный анализ сделок). В данном анализе пользователь может указать, за какой конкретно период нужно провести анализ сделок, а также установить дополнительный отбор по наименованию/ФИО контрагента. Более подробно работа с универсальным анализом будет описана в пункте 17 данной инструкции.
15.	 Для начала любого вида анализа на соответствующей вкладке необходимо нажать кнопку "Начать анализ" . При этом табличная часть, расположенная ниже, заполнится найденными сделками. Также в результате каждого вида анализа отображается информация о количестве найденных сделок и итоговых сумм (Дт и Кт) по ним.
16.	 Кроме того, по каждому виду анализа доступны следующие виды отбора:
•	Отбор по ИНН/счету. Для установки отбора, необходимо установить соответствующую галочку. Отбор возможен по нескольким ИНН/счетам. Для этого их следует вводить в столбик.
•	Отбор по назначению платежа. Для установки отбора, необходимо установить соответствующую галочку. Отбор возможен сразу по нескольким словам в назначении сделки. В результат попадут все сделки, в назначении которых встречается хоть одно слово из заданного списка. Слова для поиска также следует вводить в столбик. Поиск осуществляется без учета регистра.
•	Отбор по проценту от балансовой стоимости. Для установки отбора, необходимо установить соответствующую галочку. В данном случае сначала происходит отбор сделок за выбранный период, потом такие сделки группируются по ИНН контрагента. Если сумма сделок (отдельно по Дт, отдельно по Кт) по очередному ИНН превышает заданный процент от указанной балансовой стоимости, то такие сделки попадают в результат анализа. Если балансовая стоимость или процент указаны некорректно, программа сообщит об этом пользователю с указанием полей, которые необходимо исправить.  
17.	 Универсальный анализ сделок не учитывает дату подачи заявление о банкротстве. Для данного анализа на соответствующей вкладке можно указать период, за который необходим анализ. Для этого также должна быть указана соответствующая галочка. Если галочка указана, а дата заполнена некорректно, программа сообщит об этом пользователю с указанием полей, которые необходимо исправить. Также в универсальном анализе доступен отбор по наименованию/ФИО контрагента. Работа с ним аналогична отбору по назначению, описанному выше, с той разницей, что поиск указанных ФИО и/или наименований происходит в соответствующей колонке. 
18.	 Результат каждого отдельного вида анализа по кнопке  "Сохранить текущий результат анализа в Excel" можно сохранить в файл Excel. Пользователь может выбрать папку, в которой будет сохранен данный результат. Имя файла генерируется автоматически: к имени файла выбранной выписки дописывается краткое название вида анализа (например, «за год») и версии выгрузки (например,  v2).
19.	 После того, как весь необходимый анализ проведен по кнопке  "Сохранить полный анализ в Excel" можно сохранить сразу все таблицы с результатами по каждому виду анализа в один файл Excel. Результат каждого вида анализа будет представлен на отдельной странице сохраненного файла. Аналогично предыдущему пункту, пользователь может выбрать папку, в которой будет сохранен данный результат. Имя файла генерируется автоматически: к имени файла выбранной выписки дописывается «полный анализ» и версия выгрузки (например,  v2).
